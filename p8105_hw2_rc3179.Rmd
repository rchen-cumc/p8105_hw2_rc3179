---
title: "Homework 2"
author: "RuiJun Chen"
date: "10/2/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
```

## Problem 1
```{r}
#Read in Mr. Trash Wheel, omitting non-data entries and rows without dumpster-specific data, then rounding sports balls to integers
trash_data = 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
    range = "A2:N370") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = as.integer(sports_balls))

```

```{r}
#Read in 2017 precipitation data excluding rows without precipitation data and adding year
precip2017_data = 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
    sheet = "2017 Precipitation",
    range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  mutate(year = 2017)

#Read in 2018 precipitation data excluding rows without precipitation data and adding year
precip2018_data = 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
    sheet = "2017 Precipitation",
    range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  mutate(year = 2018)

#Combine precipitation datasets and convert month to characters
combined_precip = 
  bind_rows(precip2017_data, precip2018_data) %>% 
  mutate(month = c(month.name,month.name))
```

The Mr. Trash Wheel database shows that there are a total of `r trash_data %>% count() %>% pull(n)` observations and `r trash_data %>% pull(dumpster) %>% last()` dumpsters which collected trash between `r trash_data %>% pull(month) %>% first()` `r trash_data %>% pull(year) %>% first()` and `r trash_data %>% pull(month) %>% last()` `r trash_data %>% pull(year) %>% last()`. In total, Mr. Trash Wheel collected `r trash_data %>% pull(weight_tons) %>% sum()` tons of trash with a volume of `r trash_data %>% pull(volume_cubic_yards) %>% sum()` in cubic yards. The median number of sports balls pulled from dumpsters in 2017 was `r trash_data %>% filter(year==2017) %>% pull(sports_balls) %>% median()`. In terms of precipitation in 2017 and 2018 combined, there were a total of `r combined_precip %>% count() %>% pull(n)` observations with a total precipitation of `r combined_precip %>% filter(year==2017) %>% pull(total) %>% sum()` in 2017 and total precipitation of `r combined_precip %>% filter(year==2018) %>% pull(total) %>% sum()` in 2018. 

## Problem 2